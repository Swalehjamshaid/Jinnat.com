<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flexible SEO Audit Dashboard</title>

  <!-- Optional: Chart.js (graceful fallback if CDN blocked) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"
          integrity="sha384-8mJ3QkU6Ydfn1rL893w1L1C5O2m2nQx6z1V2OeS8nwh7B8o7wT8nWQ3nme3p0W4H"
          crossorigin="anonymous"></script>

  <style>
    :root{
      --bg:#0b1220;
      --panel:#121a2b;
      --muted:#94a3b8;
      --text:#e5e7eb;
      --brand:#60a5fa;
      --accent:#f59e0b;
      --ok:#22c55e;
      --warn:#eab308;
      --bad:#ef4444;
      --chip:#1f2a44;
      --border:#1f2a44;
    }
    [data-theme="light"]{
      --bg:#f6f7fb;
      --panel:#ffffff;
      --muted:#475569;
      --text:#0f172a;
      --brand:#2563eb;
      --accent:#d97706;
      --ok:#16a34a;
      --warn:#ca8a04;
      --bad:#dc2626;
      --chip:#eef2ff;
      --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif;
      background:var(--bg); color:var(--text);
    }
    header{
      position:sticky; top:0; z-index:50; backdrop-filter:saturate(1.2) blur(6px);
      background:linear-gradient(180deg, rgba(0,0,0,.35), transparent);
      border-bottom:1px solid var(--border);
    }
    .container{max-width:1200px; margin:0 auto; padding:16px;}
    .row{display:grid; grid-template-columns:repeat(12, 1fr); gap:16px;}
    .card{
      background:var(--panel); border:1px solid var(--border); border-radius:12px; padding:16px;
      box-shadow: 0 6px 18px rgba(0,0,0,.12);
    }
    .muted{color:var(--muted)}
    .chip{display:inline-flex; align-items:center; gap:8px; background:var(--chip); border-radius:999px; padding:6px 10px; font-size:.85rem}
    .btn{
      appearance:none; border:none; border-radius:10px; padding:10px 14px; cursor:pointer; font-weight:600;
      color:#fff; background:var(--brand); box-shadow: 0 6px 14px rgba(37,99,235,.25);
    }
    .btn.secondary{background:transparent; color:var(--text); border:1px solid var(--border)}
    .btn.warn{background:var(--accent)}
    .btn.ghost{background:transparent; color:var(--text)}
    .btn:disabled{opacity:.6; cursor:not-allowed}
    input[type="text"]{
      width:100%; padding:12px 14px; border-radius:10px; border:1px solid var(--border); background:var(--panel); color:var(--text)
    }
    .kpis{display:grid; grid-template-columns:repeat(4,1fr); gap:16px}
    @media (max-width:960px){ .kpis{grid-template-columns:repeat(2,1fr)} .row{grid-template-columns:repeat(6,1fr)} }
    @media (max-width:640px){ .kpis{grid-template-columns:1fr} .row{grid-template-columns:1fr} }
    .kpi{display:flex; flex-direction:column; gap:6px}
    .kpi .label{font-size:.9rem; color:var(--muted)}
    .kpi .value{font-size:1.8rem; font-weight:800}
    .tags{display:flex; flex-wrap:wrap; gap:8px}
    .grid-2{display:grid; grid-template-columns:1fr 1fr; gap:16px}
    @media (max-width:900px){.grid-2{grid-template-columns:1fr}}
    details{border:1px dashed var(--border); border-radius:10px; padding:10px 12px; background: color-mix(in hsl, var(--panel) 96%, transparent)}
    details > summary{cursor:pointer; font-weight:600}
    .progress{
      height:10px; background:rgba(148,163,184,.25); border-radius:999px; overflow:hidden; border:1px solid var(--border)
    }
    .progress > div{height:100%; background:linear-gradient(90deg, var(--brand), #7c3aed); width:0%}
    .status{display:flex; gap:8px; align-items:center}
    canvas{max-width:100%; height:280px}
    .json{white-space:pre-wrap; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:.85rem}
    .footer{color:var(--muted); text-align:center; font-size:.85rem; padding:24px 0}
    .score-badge{
      display:inline-flex; align-items:center; justify-content:center; width:56px; height:56px; border-radius:12px;
      font-weight:800; font-size:1.2rem; background:color-mix(in hsl, var(--ok) 30%, transparent); border:1px solid var(--border)
    }
    .grade-badge{
      display:inline-flex; align-items:center; justify-content:center; width:56px; height:56px; border-radius:50%;
      font-weight:900; font-size:1.2rem; background:color-mix(in hsl, var(--brand) 25%, transparent); border:2px solid var(--brand)
    }
    .mini{font-size:.85rem}
    .flex{display:flex; gap:12px; align-items:center}
    .space{height:8px}
    .gap-8{gap:8px}
    .mt-8{margin-top:8px}
    .mt-12{margin-top:12px}
    .mt-16{margin-top:16px}
    .mt-24{margin-top:24px}
    .mb-0{margin-bottom:0}
    .right{margin-left:auto}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="row" style="align-items:center">
        <div style="grid-column: span 12">
          <div class="flex">
            <div class="chip"><strong>SEO Audit</strong> <span class="muted mini">Ultraâ€‘Flexible UI</span></div>
            <div class="right flex gap-8">
              <button class="btn secondary" id="toggle-theme">Toggle Theme</button>
              <button class="btn ghost" id="btn-export-json">Export JSON</button>
              <button class="btn ghost" id="btn-print">Print / PDF</button>
            </div>
          </div>
          <div class="mt-12 grid-2">
            <div class="card">
              <label for="input-url" class="muted mini">Website URL</label>
              <input id="input-url" type="text" placeholder="e.g. www.haier.com.pk" value="www.haier.com.pk" />
              <div class="mt-12 flex gap-8">
                <button class="btn" id="btn-start">Start Audit</button>
                <button class="btn secondary" id="btn-paste-json">Paste JSON</button>
                <button class="btn warn" id="btn-stop" disabled>Stop</button>
                <div class="right chip">
                  <span id="status-text">Idle</span>
                </div>
              </div>
              <div class="mt-12 progress"><div id="progress-bar"></div></div>
            </div>
            <div class="card">
              <div class="flex">
                <div>
                  <div class="muted mini">Overall Score</div>
                  <div class="flex">
                    <div id="overall-score" class="score-badge">â€”</div>
                    <div class="space"></div>
                    <div>
                      <div class="muted mini">Grade</div>
                      <div id="overall-grade" class="grade-badge">â€”</div>
                    </div>
                  </div>
                </div>
                <div class="right">
                  <div class="tags" id="tags-area">
                    <span class="chip">SEO</span>
                    <span class="chip">Performance</span>
                    <span class="chip">Links</span>
                    <span class="chip">Competitors</span>
                  </div>
                </div>
              </div>
              <div class="mt-12 kpis">
                <div class="kpi"><div class="label">SEO Score</div><div id="seo-score" class="value">â€”</div></div>
                <div class="kpi"><div class="label">Performance Score</div><div id="perf-score" class="value">â€”</div></div>
                <div class="kpi"><div class="label">LCP (ms)</div><div id="lcp-ms" class="value">â€”</div></div>
                <div class="kpi"><div class="label">Top Competitor Score</div><div id="comp-score" class="value">â€”</div></div>
              </div>
            </div>
          </div>
          <div class="mt-16 grid-2">
            <div class="card">
              <h3 class="mb-0">Score Breakdown</h3>
              <div class="muted mini">Adapts to backend-provided chart_data or builds from scores</div>
              <canvas id="chart-bar"></canvas>
            </div>
            <div class="card">
              <h3 class="mb-0">Links Health</h3>
              <div class="muted mini">Healthy / Warning / Broken</div>
              <canvas id="chart-doughnut"></canvas>
              <div class="mt-12 kpis">
                <div class="kpi"><div class="label">Internal</div><div id="kpi-internal" class="value">â€”</div></div>
                <div class="kpi"><div class="label">Warning</div><div id="kpi-warning" class="value">â€”</div></div>
                <div class="kpi"><div class="label">Broken</div><div id="kpi-broken" class="value">â€”</div></div>
                <div class="kpi"><div class="label">External</div><div id="kpi-external" class="value">â€”</div></div>
              </div>
            </div>
          </div>

          <div class="mt-16 grid-2">
            <div class="card">
              <h3 class="mb-0">Competitors</h3>
              <div class="muted mini">Top 3 (if provided)</div>
              <div class="tags mt-12" id="competitors-tags"></div>
              <details class="mt-12">
                <summary>Show competitor items (names & scores)</summary>
                <div class="json" id="competitors-items-json">[]</div>
              </details>
            </div>
            <div class="card">
              <h3 class="mb-0">Raw SEO & Performance Extras</h3>
              <details class="mt-12">
                <summary>SEO Raw</summary>
                <div class="json" id="seo-raw-json">{}<div></div></div>
              </details>
              <details class="mt-12">
                <summary>Performance Extras</summary>
                <div class="json" id="perf-extras-json">{}<div></div></div>
              </details>
            </div>
          </div>

          <div class="mt-16 card">
            <h3 class="mb-0">All Data (Final Payload)</h3>
            <div class="muted mini">For debugging and future fields (always shown)</div>
            <div class="mt-12 json" id="payload-json">Waitingâ€¦</div>
          </div>

          <div class="footer">Made flexible for evolving backends Â· Works with SSE / WebSockets / Polling / JSON Paste</div>
        </div>
      </div>
    </div>
  </header>

  <script>
    /******************************************************************
     * Configuration â€” change these if your server routes are different
     ******************************************************************/
    const ENDPOINTS = {
      // Preferred: POST start (returns {jobId}) then stream via SSE / WS
      start: "/api/audit/start",
      // Or directly stream with URL param (server can start+stream in one)
      sse: "/api/audit/stream",
      ws: (location.protocol === "https:" ? "wss://" : "ws://") + location.host + "/ws/audit",
      // Optional polling endpoint (expects final JSON or streaming chunks)
      poll: "/api/audit/status"
    };

    /******************************************************************
     * Utilities
     ******************************************************************/
    const $ = (id) => document.getElementById(id);

    function safeGet(obj, path, dflt = undefined) {
      try {
        return path.split('.').reduce((o, k) => (o && k in o) ? o[k] : undefined, obj) ?? dflt;
      } catch { return dflt; }
    }

    function toInt(x, d=0){ const n = Number(x); return isNaN(n) ? d : Math.round(n); }

    function pretty(obj){
      try { return JSON.stringify(obj, null, 2); } catch { return String(obj); }
    }

    function setStatus(text, progress=null){
      $("status-text").textContent = text;
      if(progress !== null){
        $("progress-bar").style.width = Math.max(0, Math.min(100, progress)) + "%";
      }
    }

    function colorForScore(n){
      if(n >= 90) return "var(--ok)";
      if(n >= 70) return "var(--accent)";
      return "var(--bad)";
    }

    function setBadge(el, value){
      el.textContent = (value ?? "â€”");
      el.style.borderColor = colorForScore(toInt(value, 0));
      el.style.background = "linear-gradient(180deg, " + colorForScore(toInt(value, 0)) + "22, transparent)";
    }

    function addChips(container, items, icon="ðŸ·ï¸"){
      container.innerHTML = "";
      (items || []).forEach(t=>{
        const span = document.createElement("span");
        span.className="chip";
        span.textContent = `${icon} ${t}`;
        container.appendChild(span);
      });
    }

    function download(name, dataStr){
      const a = document.createElement("a");
      a.href = "data:application/json;charset=utf-8," + encodeURIComponent(dataStr);
      a.download = name;
      a.click();
    }

    function tryGetChart(){
      // Chart.js may not be available (e.g., blocked CDN); degrade gracefully
      try{
        if(typeof window.Chart !== "undefined") return window.Chart;
      }catch(e){}
      return null;
    }

    /******************************************************************
     * Charts (build if Chart.js exists; else, show fallback)
     ******************************************************************/
    let barChart, doughnutChart;

    function renderBarChart(data){
      const ctx = $("chart-bar").getContext("2d");
      const Chart = tryGetChart();
      const defaultData = {
        labels: ["SEO", "Speed", "Security", "AI"],
        datasets: [{
          label: "Scores",
          data: [ toInt($("seo-score").textContent, 0), toInt($("perf-score").textContent, 0), 90, 95 ],
          backgroundColor: [
            "rgba(255, 215, 0, 0.8)",
            "rgba(59, 130, 246, 0.8)",
            "rgba(16, 185, 129, 0.8)",
            "rgba(147, 51, 234, 0.8)"
          ],
          borderColor: [
            "rgba(255, 215, 0, 1)",
            "rgba(59, 130, 246, 1)",
            "rgba(16, 185, 129, 1)",
            "rgba(147, 51, 234, 1)"
          ],
          borderWidth: 1
        }]
      };
      const chartData = data || defaultData;

      if(Chart){
        if(barChart) barChart.destroy();
        barChart = new Chart(ctx, {
          type: "bar",
          data: chartData,
          options: { responsive:true, maintainAspectRatio:false, scales: { y: { beginAtZero:true, suggestedMax:100 } } }
        });
      }else{
        // Fallback: show minimal bars using text (no js chart)
        $("chart-bar").outerHTML = `
          <div class="mini muted">Chart unavailable (Chart.js not loaded). Showing fallback.</div>
          <div class="mt-12">
            ${(chartData.labels || []).map((lbl, i)=>{
              const v = (chartData.datasets?.[0]?.data?.[i]) ?? 0;
              return `
                <div class="mini">${lbl} â€” <strong>${v}</strong></div>
                <div class="progress"><div style="width:${Math.min(100, v)}%; background:${colorForScore(v)}"></div></div>
                <div style="height:6px"></div>
              `;
            }).join("")}
          </div>
        `;
      }
    }

    function renderDoughnutChart(data){
      const ctx = $("chart-doughnut").getContext("2d");
      const Chart = tryGetChart();
      const defaultData = {
        labels: ["Healthy", "Warning", "Broken"],
        datasets: [{
          data: [
            toInt($("kpi-internal").textContent, 0),
            toInt($("kpi-warning").textContent, 0),
            toInt($("kpi-broken").textContent, 0)
          ],
          backgroundColor: [
            "rgba(34, 197, 94, 0.7)",
            "rgba(234, 179, 8, 0.7)",
            "rgba(239, 68, 68, 0.7)"
          ],
          borderColor: [
            "rgba(34, 197, 94, 1)",
            "rgba(234, 179, 8, 1)",
            "rgba(239, 68, 68, 1)"
          ],
          borderWidth: 1
        }]
      };
      const chartData = data || defaultData;

      if(Chart){
        if(doughnutChart) doughnutChart.destroy();
        doughnutChart = new Chart(ctx, { type:"doughnut", data: chartData, options:{ responsive:true, maintainAspectRatio:false } });
      }else{
        $("chart-doughnut").outerHTML = `
          <div class="mini muted">Chart unavailable (Chart.js not loaded). Showing fallback.</div>
          ${(chartData.labels || []).map((lbl, i)=>{
            const v = (chartData.datasets?.[0]?.data?.[i]) ?? 0;
            return `
              <div class="mini">${lbl} â€” <strong>${v}</strong></div>
              <div class="progress"><div style="width:${Math.min(100, v)}%; background:${colorForScore(v)}"></div></div>
              <div style="height:6px"></div>
            `;
          }).join("")}
        `;
      }
    }

    /******************************************************************
     * Flexible Renderer (adapts to any payload shape)
     ******************************************************************/
    let lastPayload = null;

    function renderPayload(payload){
      lastPayload = payload;
      // Status/progress
      const prog = safeGet(payload, "crawl_progress");
      if(typeof prog === "number") $("progress-bar").style.width = prog + "%";

      // Overall KPIs
      setBadge($("overall-score"), safeGet(payload, "overall_score", "â€”"));
      $("overall-grade").textContent = safeGet(payload, "grade", "â€”");

      const seoScore = safeGet(payload, "breakdown.seo", 0);
      const perfScore = safeGet(payload, "breakdown.performance.score", 0);
      const lcpMs    = safeGet(payload, "breakdown.performance.lcp_ms", 0);
      const compTop  = safeGet(payload, "breakdown.competitors.top_competitor_score", 0);

      $("seo-score").textContent  = seoScore;
      $("perf-score").textContent = perfScore;
      $("lcp-ms").textContent     = lcpMs;
      $("comp-score").textContent = compTop;

      // Links KPIs
      const links = safeGet(payload, "breakdown.links", {});
      $("kpi-internal").textContent = links.internal_links_count ?? 0;
      $("kpi-warning").textContent  = links.warning_links_count ?? 0;
      $("kpi-broken").textContent   = links.broken_internal_links ?? 0;
      $("kpi-external").textContent = links.external_links_count ?? 0;

      // Competitors chips
      const compNames = safeGet(payload, "breakdown.competitors.names", []);
      addChips($("competitors-tags"), compNames, "ðŸ");
      $("competitors-items-json").textContent = pretty(safeGet(payload, "breakdown.competitors.items", []));

      // Raw extras
      $("seo-raw-json").textContent  = pretty(safeGet(payload, "extras.seo_raw", {}));
      $("perf-extras-json").textContent = pretty(safeGet(payload, "breakdown.performance.extras", {}));

      // Payload dump
      $("payload-json").textContent = pretty(payload);

      // Charts (prefer backend chart_data, else build)
      const barData = safeGet(payload, "chart_data.bar");
      const doughData = safeGet(payload, "chart_data.doughnut");

      renderBarChart(barData);
      renderDoughnutChart(doughData);

      if(payload.finished){
        setStatus("âœ… Finished", 100);
        $("btn-start").disabled = false;
        $("btn-stop").disabled = true;
      }
    }

    /******************************************************************
     * Transport Layer: SSE â†’ WebSocket â†’ Polling â†’ Manual Paste
     ******************************************************************/
    let activeSource = null; // EventSource or WebSocket
    let pollTimer = null;

    async function startAudit(){
      const url = $("input-url").value.trim();
      if(!url){ alert("Please enter a URL"); return; }
      cleanupTransports();
      $("btn-start").disabled = true; $("btn-stop").disabled = false;
      setStatus("ðŸŒ Startingâ€¦", 5);

      // Strategy 1: POST /start to get jobId, then try SSE/WS
      try{
        const res = await fetch(ENDPOINTS.start, {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body: JSON.stringify({ url })
        });
        if(res.ok){
          const data = await res.json().catch(()=> ({}));
          const jobId = data.jobId || data.id || null;
          if(jobId){
            // Try SSE with jobId
            if(trySSE(`${ENDPOINTS.sse}/${encodeURIComponent(jobId)}`)) return;
            // Try WS with jobId
            if(tryWS(`${ENDPOINTS.ws}?jobId=${encodeURIComponent(jobId)}`)) return;
            // Fallback to polling with jobId
            tryPoll(`${ENDPOINTS.poll}/${encodeURIComponent(jobId)}`);
            return;
          }
        }
      }catch(e){
        console.debug("POST start failed, will fallback:", e);
      }

      // Strategy 2: Direct SSE with ?url=
      if(trySSE(`${ENDPOINTS.sse}?url=${encodeURIComponent(url)}`)) return;

      // Strategy 3: WebSocket with ?url=
      if(tryWS(`${ENDPOINTS.ws}?url=${encodeURIComponent(url)}`)) return;

      // Strategy 4: Polling as last resort
      tryPoll(`${ENDPOINTS.poll}?url=${encodeURIComponent(url)}`);
    }

    function cleanupTransports(){
      try{ if(activeSource && activeSource.close) activeSource.close(); }catch{}
      try{ if(activeSource && activeSource.readyState===WebSocket.OPEN) activeSource.close(); }catch{}
      activeSource = null;
      if(pollTimer){ clearInterval(pollTimer); pollTimer = null; }
    }

    function trySSE(url){
      if(typeof EventSource === "undefined") return false;
      try{
        setStatus("ðŸ“¡ Connecting (SSE)â€¦", 8);
        const es = new EventSource(url);
        activeSource = es;

        es.onmessage = (ev)=>{
          try{
            const data = JSON.parse(ev.data);
            if(data.status){ setStatus(data.status, data.crawl_progress ?? null); }
            if(data.error){ setStatus("âŒ " + data.error, 100); }
            renderPayload(data);
          }catch(e){
            console.debug("SSE parse issue:", e);
          }
        };
        es.onerror = ()=>{
          setStatus("SSE error; trying fallbackâ€¦", 15);
          es.close();
          // Try WS next
          return false;
        };
        return true;
      }catch(e){
        console.debug("SSE failed:", e);
        return false;
      }
    }

    function tryWS(url){
      try{
        setStatus("ðŸ”Œ Connecting (WebSocket)â€¦", 8);
        const ws = new WebSocket(url);
        activeSource = ws;

        ws.onopen = ()=> setStatus("âœ… WS connected", 12);
        ws.onmessage = (ev)=>{
          try{
            const data = JSON.parse(ev.data);
            if(data.status){ setStatus(data.status, data.crawl_progress ?? null); }
            if(data.error){ setStatus("âŒ " + data.error, 100); }
            renderPayload(data);
          }catch(e){
            console.debug("WS parse issue:", e);
          }
        };
        ws.onerror = ()=> setStatus("WS error; trying pollingâ€¦", 18);
        ws.onclose = ()=> {
          // If not finished, try polling
          if(!lastPayload || !lastPayload.finished){
            tryPoll(ENDPOINTS.poll);
          }
        };
        return true;
      }catch(e){
        console.debug("WS failed:", e);
        return false;
      }
    }

    function tryPoll(url){
      setStatus("â³ Pollingâ€¦", 20);
      let ticks = 0;
      pollTimer = setInterval(async ()=>{
        ticks++;
        try{
          const res = await fetch(url, { headers:{ "Cache-Control":"no-cache" } });
          if(!res.ok) throw new Error("poll HTTP " + res.status);
          const text = await res.text();
          // Support NDJSON (one JSON per line) OR single JSON
          const lines = text.split(/\n+/).filter(Boolean);
          for(const line of lines){
            try{
              const data = JSON.parse(line);
              if(data.status){ setStatus(data.status, data.crawl_progress ?? null); }
              renderPayload(data);
            }catch(e){}
          }
          if(lastPayload && lastPayload.finished){
            clearInterval(pollTimer); pollTimer=null;
            setStatus("âœ… Finished", 100);
            $("btn-start").disabled = false; $("btn-stop").disabled = true;
          }else{
            const prog = 20 + Math.min(70, ticks*2);
            $("progress-bar").style.width = prog + "%";
          }
        }catch(e){
          console.debug("Polling error:", e);
          if(ticks>20){
            clearInterval(pollTimer); pollTimer=null;
            setStatus("âŒ Polling failed", 100);
            $("btn-start").disabled = false; $("btn-stop").disabled = true;
          }
        }
      }, 1500);
    }

    function stopAudit(){
      cleanupTransports();
      setStatus("â¹ï¸ Stopped by user", 100);
      $("btn-start").disabled = false; $("btn-stop").disabled = true;
    }

    /******************************************************************
     * Manual JSON Paste (for offline review or testing)
     ******************************************************************/
    function pasteJSON(){
      const txt = prompt("Paste the final JSON payload:");
      if(!txt) return;
      try{
        const data = JSON.parse(txt);
        setStatus("ðŸ“„ Rendered from pasted JSON", 100);
        renderPayload(data);
      }catch(e){
        alert("Invalid JSON. " + e.message);
      }
    }

    /******************************************************************
     * Events
     ******************************************************************/
    $("btn-start").addEventListener("click", startAudit);
    $("btn-stop").addEventListener("click", stopAudit);
    $("btn-paste-json").addEventListener("click", pasteJSON);
    $("btn-print").addEventListener("click", ()=> window.print());
    $("btn-export-json").addEventListener("click", ()=> {
      if(!lastPayload) return alert("No data yet.");
      download("audit-result.json", pretty(lastPayload));
    });

    $("toggle-theme").addEventListener("click", ()=>{
      const isLight = document.documentElement.getAttribute("data-theme")==="light";
      document.documentElement.setAttribute("data-theme", isLight ? "dark" : "light");
    });

    // Convenience: start on Enter
    $("input-url").addEventListener("keydown", (e)=>{ if(e.key==="Enter"){ startAudit(); } });

    // Initial status
    setStatus("Ready");
  </script>
</body>
</html>
